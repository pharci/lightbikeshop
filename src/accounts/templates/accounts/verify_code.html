{% extends "core/base.html" %}
{% load static %}

{% block title %}Код{% endblock %}

{% block styles %}
  {{ block.super }}
  <link rel="stylesheet" href="{% static 'accounts/css/style.css' %}">
{% endblock %}

{% block content %}
<div class="container auth">
  <div class="auth__grid">
    <section class="card auth-card">
      <form method="POST"
            action="{% if action == 'login' %}{% url 'accounts:verify_login' %}
                    {% elif action == 'registration' %}{% url 'accounts:verify_register' %}
                    {% elif action == 'recovery' %}{% url 'accounts:verify_recovery' %}
                    {% elif action == 'bind_email' %}{% url 'accounts:verify_bind_email' %}
                    {% else %}{% url 'accounts:verify_login' %}{% endif %}"
            id="code-form"
            class="form"
            novalidate>
        {% csrf_token %}

        <p class="hint u-center" style="text-align:center">
          {% if action == 'login' %}Мы отправили код для входа на вашу почту.
          {% elif action == 'registration' %}Мы отправили код для завершения регистрации.
          {% elif action == 'recovery' %}Мы отправили код для восстановления доступа.
          {% elif action == 'bind_email' %}Мы отправили код для привязки e-mail.
          {% else %}Мы отправили код на вашу почту.
          {% endif %}
        </p>

        <div class="field">
          <label for="id_code" class="label">Код из письма</label>
          <div class="code-row">
            <input
              type="text"
              id="id_code"
              name="code"
              class="input code-input"
              placeholder="XXXXXX"
              inputmode="numeric"
              autocomplete="one-time-code"
              maxlength="6"
              pattern="\d{6}"
              required
              autofocus
            />
            <button type="submit" class="btn btn--dark" id="button">Продолжить</button>
          </div>
          <p id="code-validity-error" class="error" hidden>Введите 6 цифр из письма.</p>

          {% if messages %}
            {% for message in messages %}
              {% if message.tags == 'error' %}
                <p class="error">{{ message }}</p>
              {% endif %}
            {% endfor %}
          {% endif %}
        </div>
      </form>
    </section>
  </div>
</div>
{% endblock %}

{% block scripts %}
  {{ block.super }}
  <script src="{% static 'accounts/js/verify_code.js' %}"></script>
{% endblock %}
